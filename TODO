Known problems:

Need to handle border cases for tracing up.
